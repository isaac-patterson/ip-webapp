containers:
  alpine-node:
    build_directory: ./batect/alpine-node
    working_directory: /code
    volumes: 
      - local: . 
        container: /code
      - type: cache #cache node modules to speed up
        container: /code/node_modules
        name: node_modules
    run_as_current_user:
      enabled: true
      home_directory: /home/container-user
    ports:
      - local: 3000
        container: 3000
  
tasks:
  setup:
    description: Install dependencies needed to build and run the application
    group: yarn
    run:
      container: alpine-node
      command: yarn install

  build:
    description: Builds the application into ./build
    group: yarn
    run:
      container: alpine-node
      command: yarn build

  start:
    description: Runs the application on localhost:3000
    group: yarn
    run:
      container: alpine-node
      command: yarn start

  #TODO: Setup linter
  lint:
    description: Run linting across all source code
    run:
      container: alpine-node
      command: yarn exec prettier -- -c *.ts

